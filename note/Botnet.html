<!doctype html>
<html>

<head>
    <meta charset='utf-8'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.4.1/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css">
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/texmath.css">
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">
    <title>Botnet</title>

</head>

<body class="markdown-body">
    <h1 data-line="0" class="code-line" id="botnet">Botnet</h1>
    <!-- TOC -->
    <ul>
        <li data-line="4" class="code-line"><a href="#introduction">Introduction</a></li>
        <li data-line="5" class="code-line"><a href="#starting-point">Starting Point</a></li>
        <li data-line="6" class="code-line"><a href="#botnet-components">Botnet Components</a></li>
        <li data-line="7" class="code-line"><a href="#botnet-lifecycle">Botnet Lifecycle</a></li>
        <li data-line="8" class="code-line"><a href="#botnet-cc-topologies">Botnet C&amp;C Topologies</a>
            <ul>
                <li data-line="9" class="code-line"><a href="#star">Star</a></li>
                <li data-line="10" class="code-line"><a href="#multi-server">Multi-server</a></li>
                <li data-line="11" class="code-line"><a href="#hierarchical">Hierarchical</a></li>
                <li data-line="12" class="code-line"><a href="#random">Random</a></li>
            </ul>
        </li>
        <li data-line="13" class="code-line"><a href="#rallying-mechanisms">Rallying Mechanisms</a></li>
        <li data-line="14" class="code-line"><a href="#ip-flux">IP flux</a></li>
        <li data-line="15" class="code-line"><a href="#domain-flux">Domain flux</a>
            <ul>
                <li data-line="16" class="code-line"><a href="#domain-wildcarding">Domain wildcarding</a></li>
                <li data-line="17" class="code-line"><a href="#domain-generation-algorithms">Domain generation algorithms</a></li>
            </ul>
        </li>
        <li data-line="18" class="code-line"><a href="#blind-proxy-redirection">Blind Proxy Redirection</a></li>
        <li data-line="19" class="code-line"><a href="#botnet-detection-challenges">Botnet Detection Challenges</a></li>
        <li data-line="20" class="code-line"><a href="#reference">Reference</a></li>
    </ul>
    <!-- /TOC -->
    <h2 data-line="24" class="code-line" id="introduction">Introduction</h2>
    <ul>
        <li data-line="26" class="code-line">Networks of machines compromised by malware</li>
        <li data-line="27" class="code-line">Estimated 16-25% of computers on Internet part of a botnet
            <ul>
                <li data-line="28" class="code-line">Botnet Rustock has over 1 million bots</li>
                <li data-line="29" class="code-line">Botnet Storm one of &quot;world's top super computers&quot;</li>
            </ul>
        </li>
        <li data-line="30" class="code-line">Applications
            <ul>
                <li data-line="31" class="code-line">Information and identity theft</li>
                <li data-line="32" class="code-line">Distributed denial of service (DDoS)</li>
                <li data-line="33" class="code-line">Software piracy</li>
                <li data-line="34" class="code-line">Spamming/Phishing
                    <ul>
                        <li data-line="35" class="code-line">Almost 80% of all email traffic</li>
                        <li data-line="36" class="code-line">Example: Grum, Cutwail, Rustock</li>
                    </ul>
                </li>
                <li data-line="37" class="code-line">Underground economy
                    <ul>
                        <li data-line="38" class="code-line">10,000 bots for $15</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="39" class="code-line">Scale of damage (cf. International Telecommunication Union)
            <ul>
                <li data-line="40" class="code-line">$13.2B direct damages to global economy in 2006</li>
                <li data-line="41" class="code-line">$67.2B in direct and indirect damages to US businesses in 2005</li>
                <li data-line="42" class="code-line">Global cost of spam in 2007: $100B global, $35B in US</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="44" class="code-line" id="starting-point">Starting Point</h2>
    <ul>
        <li data-line="46" class="code-line">Internet Relay Chat (IRC)
            <ul>
                <li data-line="47" class="code-line">Text-based chat system</li>
                <li data-line="48" class="code-line">Organize communications in channels</li>
                <li data-line="49" class="code-line">Botnets to control interactions in IRC chat rooms
                    <ul>
                        <li data-line="50" class="code-line">Interpret simple commands</li>
                        <li data-line="51" class="code-line">Provide administration support</li>
                        <li data-line="52" class="code-line">Offer simple games/services</li>
                        <li data-line="53" class="code-line">Retrieve information: OS, logins, emails, etc.</li>
                    </ul>
                </li>
                <li data-line="54" class="code-line">First IRC bot: Eggdrop, 1993</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="56" class="code-line" id="botnet-components">Botnet Components</h2>
    <ul>
        <li data-line="58" class="code-line">Zombies
            <ul>
                <li data-line="59" class="code-line">High transmission rates</li>
                <li data-line="60" class="code-line">Low levels of security</li>
                <li data-line="61" class="code-line">Distant locations</li>
                <li data-line="62" class="code-line">Mostly MS Windows</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="64" class="code-line" id="botnet-lifecycle">Botnet Lifecycle</h2>
    <ul>
        <li data-line="66" class="code-line">Initial infection
            <ul>
                <li data-line="67" class="code-line">infected websites, email attachments, removable media, etc.</li>
            </ul>
        </li>
        <li data-line="68" class="code-line">Secondary injection
            <ul>
                <li data-line="69" class="code-line">Host downloads &amp; runs binaries, becomes a bot</li>
                <li data-line="70" class="code-line">FTP, HTTP, or P2P</li>
            </ul>
        </li>
        <li data-line="71" class="code-line">Connection or Rally
            <ul>
                <li data-line="72" class="code-line">process of establishing connection with C&amp;C</li>
                <li data-line="73" class="code-line">Happens every time the host is restarted</li>
            </ul>
        </li>
        <li data-line="74" class="code-line">Malicious activities
            <ul>
                <li data-line="75" class="code-line">More intense message exchange between bot and C&amp;C</li>
            </ul>
        </li>
        <li data-line="76" class="code-line">Maintenance and upgrading</li>
    </ul>
    <h2 data-line="78" class="code-line" id="botnet-cc-topologies">Botnet C&amp;C Topologies</h2>
    <h3 data-line="80" class="code-line" id="star">Star</h3>
    <ul>
        <li data-line="82" class="code-line">Centralized C&amp;C communicate with all bots</li>
        <li data-line="83" class="code-line">Protocols used:
            <ul>
                <li data-line="84" class="code-line">IRC
                    <ul>
                        <li data-line="85" class="code-line">C&amp;C functionality of SDBot, GTBot, Agobot still in use</li>
                        <li data-line="86" class="code-line">Source code published by author</li>
                    </ul>
                </li>
                <li data-line="87" class="code-line">HTTP
                    <ul>
                        <li data-line="88" class="code-line">Blend in with normal user traffic</li>
                        <li data-line="89" class="code-line">Do-it-yourself kits</li>
                    </ul>
                </li>
                <li data-line="90" class="code-line">Instant-Messaging (IM) protocols
                    <ul>
                        <li data-line="91" class="code-line">ICQ, AIM, MSN Messenger</li>
                        <li data-line="92" class="code-line">Needs creating one account per bot</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="93" class="code-line">Pro:
            <ul>
                <li data-line="94" class="code-line">Speed of Control</li>
            </ul>
        </li>
        <li data-line="95" class="code-line">Con:
            <ul>
                <li data-line="96" class="code-line">Single point of failure</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="98" class="code-line" id="multi-server">Multi-server</h3>
    <ul>
        <li data-line="100" class="code-line">Extension of Star topology</li>
        <li data-line="101" class="code-line">C&amp;C servers communicate among themselves</li>
        <li data-line="102" class="code-line">Pros:
            <ul>
                <li data-line="103" class="code-line">No single point of failure</li>
                <li data-line="104" class="code-line">Geographical optimization</li>
            </ul>
        </li>
        <li data-line="105" class="code-line">Cons:
            <ul>
                <li data-line="106" class="code-line">Requires more planning/ effort from the operator</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="108" class="code-line" id="hierarchical">Hierarchical</h3>
    <ul>
        <li data-line="110" class="code-line">One group of bots acting as servants
            <ul>
                <li data-line="111" class="code-line">Static routable IP addresses</li>
                <li data-line="112" class="code-line">Proxy C&amp;C instructions to client bots</li>
            </ul>
        </li>
        <li data-line="113" class="code-line">Variant: Hierarchical Kademlia
            <ul>
                <li data-line="114" class="code-line">Set of clusters or islands of bots</li>
                <li data-line="115" class="code-line">P2P for intra-cluster communication</li>
                <li data-line="116" class="code-line">Inter-cluster communication: super bot peers</li>
            </ul>
        </li>
        <li data-line="117" class="code-line">Pros:
            <ul>
                <li data-line="118" class="code-line">Botnet awareness: Interception of botnet won't enumerate all members, unlikely to reveal C&amp;C</li>
                <li data-line="119" class="code-line">Ease of resale
                    <ul>
                        <li data-line="120" class="code-line">Lease/resale sections of botnet to other operators</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="121" class="code-line">Cons:
            <ul>
                <li data-line="122" class="code-line">Command latency: Not suitable for real-time activities</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="124" class="code-line" id="random">Random</h3>
    <ul>
        <li data-line="126" class="code-line">No centralized C&amp;C
            <ul>
                <li data-line="127" class="code-line">Commands injected by botmaster via any bot by sharing/publishing command files</li>
                <li data-line="128" class="code-line">Commands signed as authoritative to avoid takeover</li>
            </ul>
        </li>
        <li data-line="129" class="code-line">Future: Skype-based botnets
            <ul>
                <li data-line="130" class="code-line">Better blend in with other P2P traffic</li>
            </ul>
        </li>
        <li data-line="131" class="code-line">Pros:
            <ul>
                <li data-line="132" class="code-line">Highly resilient</li>
            </ul>
        </li>
        <li data-line="133" class="code-line">Cons:
            <ul>
                <li data-line="134" class="code-line">Command latency</li>
                <li data-line="135" class="code-line">Botnet enumeration</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="137" class="code-line" id="rallying-mechanisms">Rallying Mechanisms</h2>
    <ul>
        <li data-line="139" class="code-line">C&amp;C location resolution</li>
        <li data-line="140" class="code-line">Static Lists * Hard-coded list of IP addresses * Can be detected via a feed of botnet IPs</li>
        <li data-line="143" class="code-line">Fluxing
            <ul>
                <li data-line="144" class="code-line">Add resilience</li>
                <li data-line="145" class="code-line">Types
                    <ul>
                        <li data-line="146" class="code-line">IP flux</li>
                        <li data-line="147" class="code-line">Domain flux</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h2 data-line="149" class="code-line" id="ip-flux">IP flux</h2>
    <ul>
        <li data-line="151" class="code-line">Constant changing of IP address information</li>
        <li data-line="152" class="code-line">Single flux
            <ul>
                <li data-line="153" class="code-line">Multiple (100s-1000s) IP addresses associated with a domain name</li>
                <li data-line="155" class="code-line">IP addresses registered and de-registered rapidly
                    <ul>
                        <li data-line="156" class="code-line">Round-robin allocation</li>
                        <li data-line="157" class="code-line">Short Time to Live (TTL) for DNS A records</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="158" class="code-line">Double flux
            <ul>
                <li data-line="159" class="code-line">Flux IP address of fully-qualified domain name</li>
                <li data-line="160" class="code-line">Flux IP address of DNS server (NS records) used to look up IP address</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="162" class="code-line" id="domain-flux">Domain flux</h2>
    <h3 data-line="164" class="code-line" id="domain-wildcarding">Domain wildcarding</h3>
    <ul>
        <li data-line="166" class="code-line">Use wildcarding in DNS records
            <ul>
                <li data-line="167" class="code-line">Example: *.domain.com</li>
            </ul>
        </li>
        <li data-line="168" class="code-line">Useful for spamming/phishing; wildcard information used to
            <ul>
                <li data-line="169" class="code-line">Identify victim (e.g., <a href="http://rjhgbrwh.domain.com">rjhgbrwh.domain.com</a>)</li>
                <li data-line="170" class="code-line">Track success</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="172" class="code-line" id="domain-generation-algorithms">Domain generation algorithms</h3>
    <ul>
        <li data-line="174" class="code-line">Create a dynamic list of FQDN's every day
            <ul>
                <li data-line="175" class="code-line">Cryptographic domain names</li>
            </ul>
        </li>
        <li data-line="176" class="code-line">Generated FQDN's polled by bot to find C&amp;C</li>
        <li data-line="177" class="code-line">Example: the worm Conficker.C
            <ul>
                <li data-line="178" class="code-line">Generates 50,000 domain names every day</li>
                <li data-line="179" class="code-line">Attempts to contact 500</li>
                <li data-line="180" class="code-line">1% chance of update every day if operator registers only 1 domain per day</li>
                <li data-line="181" class="code-line">Preventing update requires registering 50,000 new domains every day</li>
            </ul>
        </li>
        <li data-line="182" class="code-line">Benefit
            <ul>
                <li data-line="183" class="code-line">Domain names generated in volume, with short (typically 1-day) life span</li>
                <li data-line="184" class="code-line">Very difficult to investigate/block all possible domain names</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="186" class="code-line" id="blind-proxy-redirection">Blind Proxy Redirection</h2>
    <ul>
        <li data-line="188" class="code-line">Add an extra layer of resiliency</li>
        <li data-line="189" class="code-line">Proxy IP/domain lookup and C&amp;C traffic</li>
    </ul>
    <h2 data-line="191" class="code-line" id="botnet-detection-challenges">Botnet Detection Challenges</h2>
    <ul>
        <li data-line="193" class="code-line">Botnet traffic similar to normal traffic
            <ul>
                <li data-line="194" class="code-line">Likely encrypted as well</li>
            </ul>
        </li>
        <li data-line="195" class="code-line">Botnets evolve rapidly
            <ul>
                <li data-line="196" class="code-line">New bots constantly getting added</li>
                <li data-line="197" class="code-line">Changing protocols</li>
                <li data-line="198" class="code-line">Changing architectures</li>
                <li data-line="199" class="code-line">Changing infection models</li>
                <li data-line="200" class="code-line">Fast flux hosting</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="202" class="code-line" id="reference">Reference</h2>
    <ul>
        <li data-line="204" class="code-line">CS 259D Lecture 2</li>
    </ul>

</body>

</html>