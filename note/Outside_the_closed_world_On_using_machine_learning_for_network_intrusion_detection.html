<!doctype html>
<html>

<head>
    <meta charset='utf-8'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.4.1/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css">
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/texmath.css">
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">
    <title>Outside the Closed World: On Using Machine Learning for Network Intrusion Detection</title>

</head>

<body class="markdown-body">
    <h1 data-line="0" class="code-line" id="outside-the-closed-world-on-using-machine-learning-for-network-intrusion-detection">Outside the Closed World: On Using Machine Learning for Network Intrusion Detection</h1>
    <!-- TOC -->
    <ul>
        <li data-line="3" class="code-line"><a href="#background-knowledge-and-insight">Background Knowledge and Insight</a></li>
        <li data-line="4" class="code-line"><a href="#challenges-of-using-machine-learning">Challenges of Using Machine Learning</a>
            <ul>
                <li data-line="5" class="code-line"><a href="#outlier-detection">Outlier Detection</a></li>
                <li data-line="6" class="code-line"><a href="#high-cost-of-errors">High Cost of Errors</a></li>
                <li data-line="7" class="code-line"><a href="#semantic-gap-interpretation-of-results">Semantic Gap, Interpretation of Results</a></li>
                <li data-line="8" class="code-line"><a href="#diversity-of-network-traffic">Diversity of Network Traffic</a></li>
                <li data-line="9" class="code-line"><a href="#adaptive-adversaries">Adaptive adversaries</a></li>
                <li data-line="10" class="code-line"><a href="#difficulties-with-evaluation">Difficulties with Evaluation</a></li>
            </ul>
        </li>
        <li data-line="11" class="code-line"><a href="#recommendations-for-using-machine-learning">Recommendations for using Machine Learning</a>
            <ul>
                <li data-line="12" class="code-line"><a href="#understanding-the-threat-model">Understanding the Threat Model</a></li>
                <li data-line="13" class="code-line"><a href="#keeping-the-scope-narrow">Keeping The Scope Narrow</a></li>
                <li data-line="14" class="code-line"><a href="#reducing-the-costs">Reducing the Costs</a></li>
                <li data-line="15" class="code-line"><a href="#evaluation">Evaluation</a></li>
            </ul>
        </li>
        <li data-line="16" class="code-line"><a href="#reference">Reference</a></li>
    </ul>
    <!-- /TOC -->
    <h2 data-line="20" class="code-line" id="background-knowledge-and-insight">Background Knowledge and Insight</h2>
    <ul>
        <li data-line="22" class="code-line">Network Intrusion Detection Systems (NIDS)
            <ul>
                <li data-line="23" class="code-line">Misuse detection
                    <ul>
                        <li data-line="24" class="code-line"><em>Exact descriptions</em> of known bad behavior</li>
                    </ul>
                </li>
                <li data-line="25" class="code-line">Anomaly detection
                    <ul>
                        <li data-line="26" class="code-line">Deviations from profiles of normal behavior</li>
                        <li data-line="27" class="code-line">Without <em>precisely describe</em> activity</li>
                        <li data-line="28" class="code-line">First proposed in 1987 by Dorothy Denning (Stanford Research Institute)</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="29" class="code-line">Misuse detectors are used more commonly than anomaly detectors
            <ul>
                <li data-line="30" class="code-line">Despite lots of research on anomaly detection</li>
                <li data-line="31" class="code-line">Despite anomaly detection is suitable for finding <em>novel</em> attacks</li>
                <li data-line="32" class="code-line">Despite success of machine learning in many other areas</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="34" class="code-line" id="challenges-of-using-machine-learning">Challenges of Using Machine Learning</h2>
    <h3 data-line="36" class="code-line" id="outlier-detection">Outlier Detection</h3>
    <table>
        <thead>
            <tr>
                <th></th>
                <th>Classification</th>
                <th>Outlier detection</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Training samples</td>
                <td>Many from both classes</td>
                <td>Almost all from one class</td>
            </tr>
            <tr>
                <td>Required quality</td>
                <td>Enough to distinguish two classes</td>
                <td>Perfect model of normal</td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="43" class="code-line">Premise: Anomaly detection can find <strong>novel</strong> attacks</li>
        <li data-line="44" class="code-line">Fact: ML is better at finding similar patterns than at finding outliers
            <ul>
                <li data-line="45" class="code-line">Example: Recommend similar products; similarity: products purchased together</li>
            </ul>
        </li>
        <li data-line="46" class="code-line">Conclusion: ML is better for finding variants of <strong>known</strong> attacks</li>
        <li data-line="47" class="code-line">Hard to create <strong>a &quot;closed&quot; world</strong>
            <ul>
                <li data-line="48" class="code-line">Cover all cases</li>
            </ul>
        </li>
        <li data-line="49" class="code-line">Underlying assumptions
            <ul>
                <li data-line="50" class="code-line">Malicious activity is anomalous</li>
                <li data-line="51" class="code-line">Anomalies correspond to malicious activity</li>
            </ul>
        </li>
        <li data-line="52" class="code-line">Do these assumptions hold?
            <ul>
                <li data-line="53" class="code-line">Former employee requests authorization code
                    <ul>
                        <li data-line="54" class="code-line">Account revocation bug? Insider threat?</li>
                        <li data-line="55" class="code-line">Username typo</li>
                        <li data-line="56" class="code-line">Brute force attack?</li>
                        <li data-line="57" class="code-line">User changed password, forgot to update script</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h3 data-line="59" class="code-line" id="high-cost-of-errors">High Cost of Errors</h3>
    <table>
        <thead>
            <tr>
                <th></th>
                <th>Cost of False Negatives</th>
                <th>Cost of False Positives</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Product recommendation</td>
                <td>Low: potential missed sales</td>
                <td>Low: continue shopping</td>
            </tr>
            <tr>
                <td>Spam detection</td>
                <td>Low: spam finding way to inbox</td>
                <td><strong>High</strong>: missed important email</td>
            </tr>
            <tr>
                <td>Intrusion detection</td>
                <td><strong>High</strong>: Arbitrary damage</td>
                <td><strong>High</strong>: wasted precious analyst time</td>
            </tr>
        </tbody>
    </table>
    <h3 data-line="68" class="code-line" id="semantic-gap-interpretation-of-results">Semantic Gap, Interpretation of Results</h3>
    <ul>
        <li data-line="70" class="code-line">Network operator needs actionable reports
            <ul>
                <li data-line="71" class="code-line">What does the anomaly mean?</li>
                <li data-line="72" class="code-line">Abnormal activity vs. Attack</li>
                <li data-line="73" class="code-line">Incorporation of site-specific security policies</li>
                <li data-line="74" class="code-line">Relation between features of anomaly detection &amp; semantics of environment</li>
            </ul>
        </li>
        <li data-line="75" class="code-line">Local security policies
            <ul>
                <li data-line="76" class="code-line">Difference between academic and enterprise environment</li>
            </ul>
        </li>
        <li data-line="77" class="code-line">Vague security policies
            <ul>
                <li data-line="78" class="code-line">eg: Tolerate P2P, &quot;appropriate&quot;, &quot;egregiously large&quot;</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="80" class="code-line" id="diversity-of-network-traffic">Diversity of Network Traffic</h3>
    <ul>
        <li data-line="82" class="code-line">Variability across all layers of the network
            <ul>
                <li data-line="83" class="code-line">Even most basic characteristics: bandwidth, duration of connections, application mix</li>
                <li data-line="84" class="code-line">Various occurs regularly</li>
                <li data-line="85" class="code-line">From packet-level to application-layer-level</li>
            </ul>
        </li>
        <li data-line="86" class="code-line">Large bursts of activity</li>
        <li data-line="87" class="code-line">What is a stable notion of normality?</li>
        <li data-line="88" class="code-line">Anomalies â‰  Attacks</li>
        <li data-line="89" class="code-line">One solution: Reduced granularity
            <ul>
                <li data-line="90" class="code-line">Example: Time-of-Day, Day-of-Week effects exhibit reliable patterns</li>
                <li data-line="91" class="code-line">Pro: More stable</li>
                <li data-line="92" class="code-line">Con: Reduced visibility</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="94" class="code-line" id="adaptive-adversaries">Adaptive adversaries</h3>
    <ul>
        <li data-line="96" class="code-line">Adversaries adapt
            <ul>
                <li data-line="97" class="code-line">ML assumptions do not necessarily hold
                    <ul>
                        <li data-line="98" class="code-line">I.I.D, stationary distributions, linear separability, etc.</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="99" class="code-line">ML algorithm itself can be an attack target
            <ul>
                <li data-line="100" class="code-line">Mistraining, evasion</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="102" class="code-line" id="difficulties-with-evaluation">Difficulties with Evaluation</h3>
    <ul>
        <li data-line="104" class="code-line">Difficulties of data
            <ul>
                <li data-line="105" class="code-line">Data's sensitive nature
                    <ul>
                        <li data-line="106" class="code-line">Personal communications</li>
                        <li data-line="107" class="code-line">Organization's business secret</li>
                        <li data-line="108" class="code-line">Nerwork access patterns</li>
                    </ul>
                </li>
                <li data-line="109" class="code-line">Lack of appropriate public data
                    <ul>
                        <li data-line="110" class="code-line">DARPA/Lincoln Labs packet traces</li>
                        <li data-line="111" class="code-line">KDD Cup dataset</li>
                        <li data-line="112" class="code-line"><a href="https://github.com/wtsxDev/Machine-Learning-for-Cyber-Security#-datasets">Machine-Learning-for-Cyber-Security datasets</a></li>
                        <li data-line="113" class="code-line"><a href="https://github.com/jivoi/awesome-ml-for-cybersecurity#table-of-contents">awesome-ml-for-cybersecurity Datasets</a></li>
                    </ul>
                </li>
                <li data-line="114" class="code-line">Simulation
                    <ul>
                        <li data-line="115" class="code-line">Capturing characteristics of real data</li>
                        <li data-line="116" class="code-line">Capturing novel attack detection</li>
                    </ul>
                </li>
                <li data-line="117" class="code-line">Anonymization
                    <ul>
                        <li data-line="118" class="code-line">Fear of de-anonymization</li>
                        <li data-line="119" class="code-line">Removing features of interest to anomaly detection</li>
                    </ul>
                </li>
                <li data-line="120" class="code-line">Assemble own datasets
                    <ul>
                        <li data-line="121" class="code-line">Not large enough
                            <ul>
                                <li data-line="122" class="code-line">Network size</li>
                                <li data-line="123" class="code-line">Datasets size</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="124" class="code-line">Interpreting the results
            <ul>
                <li data-line="125" class="code-line">&quot;HTTP traffic of host did not match profile&quot;</li>
                <li data-line="126" class="code-line">Contrast with spam detection: Little room for interpretation</li>
            </ul>
        </li>
        <li data-line="127" class="code-line">Adversarial setting
            <ul>
                <li data-line="128" class="code-line">Contrast with product recommendation: Little incentive to mislead the recommendation system</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="130" class="code-line" id="recommendations-for-using-machine-learning">Recommendations for using Machine Learning</h2>
    <h3 data-line="132" class="code-line" id="understanding-the-threat-model">Understanding the Threat Model</h3>
    <ul>
        <li data-line="134" class="code-line">What kind of target environment?
            <ul>
                <li data-line="135" class="code-line">Academic vs enterprise; small vs large/backbone</li>
            </ul>
        </li>
        <li data-line="136" class="code-line">Cost of missed attacks
            <ul>
                <li data-line="137" class="code-line">Security demands, other deployed detectors</li>
            </ul>
        </li>
        <li data-line="138" class="code-line">Attackers' skills and resources
            <ul>
                <li data-line="139" class="code-line">Targeted vs background radiation</li>
            </ul>
        </li>
        <li data-line="140" class="code-line">Risk posed by evasion</li>
    </ul>
    <h3 data-line="142" class="code-line" id="keeping-the-scope-narrow">Keeping The Scope Narrow</h3>
    <ul>
        <li data-line="144" class="code-line">What are the specific attacks to detect?</li>
        <li data-line="145" class="code-line">Choose the right tool for the task
            <ul>
                <li data-line="146" class="code-line">ML not a silver bullet</li>
                <li data-line="147" class="code-line">Common pitfall: Start with intention to use ML or even worse a particular ML tool</li>
                <li data-line="148" class="code-line">No Free Lunch Theorem</li>
            </ul>
        </li>
        <li data-line="149" class="code-line">Not only mathematical guarantee, suit for domain-specific properties</li>
        <li data-line="150" class="code-line">Insight into the features' significance and capabilities</li>
        <li data-line="151" class="code-line">Example: Anomalous payload-based network intrusion detection, Wang-Stolfo 2004
            <ul>
                <li data-line="152" class="code-line">Features: Byte frequencies in packet payloads</li>
                <li data-line="153" class="code-line">Algorithm: Detect packets with anomalous frequency patterns</li>
                <li data-line="154" class="code-line">Assumption: Attack payloads have different payload byte frequencies</li>
                <li data-line="155" class="code-line">Question: Where does this assumption come from?</li>
            </ul>
        </li>
        <li data-line="156" class="code-line">Example: Anomaly Detection of Web-based Attacks, C. Kruegel and G. Vigna 2003
            <ul>
                <li data-line="157" class="code-line">Threat model
                    <ul>
                        <li data-line="158" class="code-line">Web-based attacks using input parameters to web applications</li>
                    </ul>
                </li>
                <li data-line="159" class="code-line">Why anomaly detection
                    <ul>
                        <li data-line="160" class="code-line">Attacks share conceptual similarities, yet different enough in their specifics for signatures</li>
                    </ul>
                </li>
                <li data-line="161" class="code-line">Data
                    <ul>
                        <li data-line="162" class="code-line">Successful GET requests to CGI apps, from web server Access Logs</li>
                    </ul>
                </li>
                <li data-line="163" class="code-line">Features
                    <ul>
                        <li data-line="164" class="code-line">Length of attribute value, Character distribution of attribute value</li>
                    </ul>
                </li>
                <li data-line="165" class="code-line">Why is this feature relevant
                    <ul>
                        <li data-line="166" class="code-line">Length: Buffer overflow needs to send shellcode and padding</li>
                        <li data-line="167" class="code-line">Character distribution: Directory traversal uses too many &quot;.&quot; &amp; &quot;/&quot;</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h3 data-line="169" class="code-line" id="reducing-the-costs">Reducing the Costs</h3>
    <ul>
        <li data-line="171" class="code-line">Reduce the system's scope</li>
        <li data-line="172" class="code-line">Classification over outlier detection</li>
        <li data-line="173" class="code-line">Aggregate or averaging features over suitable intervals
            <ul>
                <li data-line="174" class="code-line">Features on different granularity</li>
            </ul>
        </li>
        <li data-line="175" class="code-line">Post-process the alerts with the support of additional information</li>
        <li data-line="176" class="code-line">Provide meta-information to analyst to speed up inspection</li>
    </ul>
    <h3 data-line="178" class="code-line" id="evaluation">Evaluation</h3>
    <ul>
        <li data-line="180" class="code-line">Working with data
            <ul>
                <li data-line="181" class="code-line">Gold Standard
                    <ul>
                        <li data-line="182" class="code-line">Real network traffic</li>
                        <li data-line="183" class="code-line">Large network</li>
                        <li data-line="184" class="code-line">Different networks</li>
                    </ul>
                </li>
                <li data-line="185" class="code-line"><strong>Not bring the data to the experimenter, bring the experiment to the data</strong></li>
                <li data-line="186" class="code-line">No dataset is perfect</li>
                <li data-line="187" class="code-line">Separate training data and testing data</li>
            </ul>
        </li>
        <li data-line="188" class="code-line">Understanding results
            <ul>
                <li data-line="189" class="code-line">Manually examine FP</li>
                <li data-line="190" class="code-line">FN harder to investigate than FP
                    <ul>
                        <li data-line="191" class="code-line">Use a different mechanism to label the input</li>
                        <li data-line="192" class="code-line">Manually label a subset input</li>
                    </ul>
                </li>
                <li data-line="193" class="code-line">Include TP and TF
                    <ul>
                        <li data-line="194" class="code-line">A ML system can produces correct results even learned nothing</li>
                    </ul>
                </li>
                <li data-line="195" class="code-line">Causality</li>
                <li data-line="196" class="code-line">Require low-latency real-time detection</li>
                <li data-line="197" class="code-line">Local environment optimization</li>
            </ul>
        </li>
        <li data-line="198" class="code-line">Develop insight into anomaly detection system's capabilities
            <ul>
                <li data-line="199" class="code-line">What can/can't it detect? Why?</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="201" class="code-line" id="reference">Reference</h2>
    <ul>
        <li data-line="203" class="code-line">Outside the closed world: On using machine learning for network intrusion detection, Sommer-Paxson, 2010</li>
        <li data-line="204" class="code-line">CS 259D Session 13</li>
    </ul>

</body>

</html>