<!doctype html>
<html>

<head>
    <meta charset='utf-8'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.4.1/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css">
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/texmath.css">
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">
    <title>A Comprehensive Approach to Intrusion Detection Alert Correlation</title>

</head>

<body class="markdown-body">
    <h1 data-line="0" class="code-line" id="a-comprehensive-approach-to-intrusion-detection-alert-correlation">A Comprehensive Approach to Intrusion Detection Alert Correlation</h1>
    <!-- TOC -->
    <ul>
        <li data-line="4" class="code-line"><a href="#background-knowledge-and-insight">Background Knowledge and Insight</a></li>
        <li data-line="5" class="code-line"><a href="#goal-and-contribution">Goal and Contribution</a></li>
        <li data-line="6" class="code-line"><a href="#data">Data</a></li>
        <li data-line="7" class="code-line"><a href="#feature">Feature</a></li>
        <li data-line="8" class="code-line"><a href="#architecture">Architecture</a>
            <ul>
                <li data-line="9" class="code-line"><a href="#components">Components</a></li>
            </ul>
        </li>
        <li data-line="10" class="code-line"><a href="#alert-process">Alert Process</a>
            <ul>
                <li data-line="11" class="code-line"><a href="#meta-alerts">Meta-alerts</a></li>
                <li data-line="12" class="code-line"><a href="#example-attack-scenario">Example Attack Scenario</a></li>
                <li data-line="13" class="code-line"><a href="#alert-normalization">Alert Normalization</a></li>
                <li data-line="14" class="code-line"><a href="#alert-preprocessing">Alert Preprocessing</a></li>
                <li data-line="15" class="code-line"><a href="#alert-fusion">Alert Fusion</a></li>
                <li data-line="16" class="code-line"><a href="#alert-verification">Alert Verification</a></li>
                <li data-line="17" class="code-line"><a href="#attack-thread-reconstruction">Attack Thread Reconstruction</a></li>
                <li data-line="18" class="code-line"><a href="#attack-session-reconstruction">Attack Session Reconstruction</a></li>
                <li data-line="19" class="code-line"><a href="#attack-focus-recognition">Attack Focus Recognition</a></li>
                <li data-line="20" class="code-line"><a href="#multistep-correlation">Multistep Correlation</a></li>
                <li data-line="21" class="code-line"><a href="#impact-analysis">Impact Analysis</a></li>
                <li data-line="22" class="code-line"><a href="#alert-prioritization">Alert Prioritization</a></li>
            </ul>
        </li>
        <li data-line="23" class="code-line"><a href="#reference">Reference</a></li>
    </ul>
    <!-- /TOC -->
    <h2 data-line="27" class="code-line" id="background-knowledge-and-insight">Background Knowledge and Insight</h2>
    <ul>
        <li data-line="29" class="code-line">How to cover multiple aspects &quot;as a whole&quot;</li>
    </ul>
    <h2 data-line="31" class="code-line" id="goal-and-contribution">Goal and Contribution</h2>
    <ul>
        <li data-line="33" class="code-line">Comprehensive correlation approach</li>
        <li data-line="34" class="code-line">Build a Framework</li>
    </ul>
    <h2 data-line="36" class="code-line" id="data">Data</h2>
    <table>
        <thead>
            <tr>
                <th>Data Set</th>
                <th>Sensors</th>
                <th>Duration</th>
                <th>Alerts</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>IT/LL 1999</td>
                <td>USTAT, Snort</td>
                <td>2 weeks</td>
                <td>41760</td>
            </tr>
            <tr>
                <td>MIT/LL 2000</td>
                <td>USTAT, Snort</td>
                <td>3 hours</td>
                <td>36635</td>
            </tr>
            <tr>
                <td>CTV</td>
                <td>Snort, EBayes-TCP, U-STAT, WinSTAT, Tripwire</td>
                <td>2 days</td>
                <td>215190</td>
            </tr>
            <tr>
                <td>Defcon</td>
                <td>Snort</td>
                <td>2 days</td>
                <td>6378096</td>
            </tr>
            <tr>
                <td>Rome AFRL</td>
                <td>Snort and undisclosed NIDS</td>
                <td>4 months</td>
                <td>5299390</td>
            </tr>
            <tr>
                <td>Honeypot</td>
                <td>Snort</td>
                <td>10 days</td>
                <td>260120</td>
            </tr>
            <tr>
                <td>Treasure Hunt</td>
                <td>Snort, LinSTAT</td>
                <td>4 hours</td>
                <td>2811169</td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="49" class="code-line">Two existing data sets
            <ul>
                <li data-line="50" class="code-line">DARPA
                    <ul>
                        <li data-line="51" class="code-line">MIT Lincoln Laboratory 1999</li>
                        <li data-line="52" class="code-line">MIT Lincoln Laboratory 2000</li>
                    </ul>
                </li>
                <li data-line="53" class="code-line">Defcon 9</li>
                <li data-line="54" class="code-line">Shortcoming
                    <ul>
                        <li data-line="55" class="code-line">Created to evaluate IDS, not include sensor alerts</li>
                        <li data-line="56" class="code-line">Not real environment, not real time</li>
                        <li data-line="57" class="code-line">Lack of network health monitoring information
                            <ul>
                                <li data-line="58" class="code-line">Difficult to determine the actual impact of the attacks</li>
                            </ul>
                        </li>
                        <li data-line="59" class="code-line">Not include anomalous traffic, non-anomalous behavior</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="60" class="code-line">Three additional data sets
            <ul>
                <li data-line="61" class="code-line">Two honeypot systems
                    <ul>
                        <li data-line="62" class="code-line">RedHat 7.2 Linux</li>
                        <li data-line="63" class="code-line">Microsoft Windows 2000 Server</li>
                    </ul>
                </li>
                <li data-line="64" class="code-line">Cyber Treasure Hunt competition</li>
                <li data-line="65" class="code-line">Rome Air Force Research Laboratoryâ€™s networks
                    <ul>
                        <li data-line="66" class="code-line">No successful attacks.</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="67" class="code-line">Manually perform the correctness of the correction process</li>
    </ul>
    <h2 data-line="69" class="code-line" id="feature">Feature</h2>
    <h2 data-line="71" class="code-line" id="architecture">Architecture</h2>
    <p data-line="73" class="code-line"><img src="images/alert_correlation.png" alt=" Correlation process overview"></p>
    <ul>
        <li data-line="75" class="code-line">Optional</li>
        <li data-line="76" class="code-line">Parallel</li>
        <li data-line="77" class="code-line">Feedback as input</li>
    </ul>
    <h3 data-line="79" class="code-line" id="components">Components</h3>
    <ul>
        <li data-line="81" class="code-line">Normalization
            <ul>
                <li data-line="82" class="code-line">Translate alerts to a common format</li>
                <li data-line="83" class="code-line">Alerts from different sensors can be encoded in different formats</li>
            </ul>
        </li>
        <li data-line="84" class="code-line">Preprocessing
            <ul>
                <li data-line="85" class="code-line">augment normalized alerts by assigning meaningful values to all alert attributes
                    <ul>
                        <li data-line="86" class="code-line">Start time</li>
                        <li data-line="87" class="code-line">End time</li>
                        <li data-line="88" class="code-line">Source</li>
                        <li data-line="89" class="code-line">Target</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="90" class="code-line">Fusion
            <ul>
                <li data-line="91" class="code-line">Combine alerts representing the same attack by different IDSs</li>
            </ul>
        </li>
        <li data-line="92" class="code-line">Verification
            <ul>
                <li data-line="93" class="code-line">Determine the success of the single attack corresponding to the alert</li>
                <li data-line="94" class="code-line">Decrease the influence of the failed attacks</li>
            </ul>
        </li>
        <li data-line="95" class="code-line">Thread reconstruction
            <ul>
                <li data-line="96" class="code-line">Combine series of alerts due to attacks by a single attacker against a single target</li>
            </ul>
        </li>
        <li data-line="97" class="code-line">Session reconstruction
            <ul>
                <li data-line="98" class="code-line">Associate network-based alerts and host-based alerts</li>
            </ul>
        </li>
        <li data-line="99" class="code-line">Focus recognition
            <ul>
                <li data-line="100" class="code-line">Identify hosts that are source or target of many attacks
                    <ul>
                        <li data-line="101" class="code-line">DoS</li>
                        <li data-line="102" class="code-line">port scanning</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="103" class="code-line">Multistep correlation
            <ul>
                <li data-line="104" class="code-line">Identify common attack patterns
                    <ul>
                        <li data-line="105" class="code-line">Sequence of individual attacks at different points of network
                            <ul>
                                <li data-line="106" class="code-line">Island hopping</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="107" class="code-line">Impact analysis
            <ul>
                <li data-line="108" class="code-line">Determine the attack impact for the specific target network</li>
            </ul>
        </li>
        <li data-line="109" class="code-line">Prioritization
            <ul>
                <li data-line="110" class="code-line">Assign priorities to alerts</li>
            </ul>
        </li>
    </ul>
    <h2 data-line="112" class="code-line" id="alert-process">Alert Process</h2>
    <h3 data-line="114" class="code-line" id="meta-alerts">Meta-alerts</h3>
    <ul>
        <li data-line="116" class="code-line">Definition:
            <ul>
                <li data-line="117" class="code-line">Higher-level alerts made via merging</li>
                <li data-line="118" class="code-line">Attribute values derived from those of original alerts</li>
            </ul>
        </li>
        <li data-line="119" class="code-line">Example:
            <ul>
                <li data-line="120" class="code-line">a &quot;portscan&quot; alert composed of a series of alerts referring to individual network probe packets</li>
                <li data-line="121" class="code-line">Target attribute: all hosts that were port-scanned</li>
            </ul>
        </li>
        <li data-line="122" class="code-line">Representation:
            <ul>
                <li data-line="123" class="code-line">A tree with IDS alerts at the leaves</li>
                <li data-line="124" class="code-line">Merging done in a BFS fashion</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="126" class="code-line" id="example-attack-scenario">Example Attack Scenario</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>IIS Exploit</td>
                <td>N1</td>
                <td>12.0/12.0</td>
                <td>80.0.0.1</td>
                <td>10.0.0.1, port:80</td>
                <td></td>
            </tr>
            <tr>
                <td>2</td>
                <td>Scanning</td>
                <td>N2</td>
                <td>10.1/14.8</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1</td>
                <td></td>
            </tr>
            <tr>
                <td>3</td>
                <td>Portsacn</td>
                <td>N1</td>
                <td>10.0/15.0</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1</td>
                <td></td>
            </tr>
            <tr>
                <td>4</td>
                <td>Apache Exploit</td>
                <td>N1</td>
                <td>22.0/22.0</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1, port:80</td>
                <td></td>
            </tr>
            <tr>
                <td>5</td>
                <td>Bad Request</td>
                <td>A</td>
                <td>22.1/22.1</td>
                <td></td>
                <td>localhost, Apache</td>
                <td></td>
            </tr>
            <tr>
                <td>6</td>
                <td>Local Exploit</td>
                <td>H</td>
                <td>24.6/24.6</td>
                <td></td>
                <td>linuxconf</td>
                <td></td>
            </tr>
            <tr>
                <td>7</td>
                <td>Local Exploit</td>
                <td>H</td>
                <td>24.7/24.7</td>
                <td></td>
                <td>linuxconf</td>
                <td></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="138" class="code-line">Victim network
            <ul>
                <li data-line="139" class="code-line">Vulnerable Apache Web service on a Linux host (IP: 10.0.0.1)</li>
                <li data-line="140" class="code-line">Host-based IDS (H)</li>
                <li data-line="141" class="code-line">Application-based IDS (A): monitors Apache Web logs for malicious activity</li>
                <li data-line="142" class="code-line">Two different network-based IDSs (N1 and N2)</li>
            </ul>
        </li>
        <li data-line="143" class="code-line">Attack process
            <ul>
                <li data-line="144" class="code-line">Attacker (IP: 31.3.3.7) first portscans host
                    <ul>
                        <li data-line="145" class="code-line">Discovers vulnerable Apache server (Alerts 2, 3)</li>
                    </ul>
                </li>
                <li data-line="146" class="code-line">During scan a worm (IP: 80.0.0.1) attempts Microsoft IIS exploit and fails (Alert 1)</li>
                <li data-line="147" class="code-line">After scan, attacker exploits Apache buffer overflow (Alerts 4, 5)
                    <ul>
                        <li data-line="148" class="code-line">Gets interactive hell as apache user</li>
                    </ul>
                </li>
                <li data-line="149" class="code-line">Using a local exploit against linuxconf, attacker becomes root (Alerts 6, 7)</li>
                <li data-line="150" class="code-line">Desired output of correlation: Single meta-alert for a multi-step attack against victim host
                    <ul>
                        <li data-line="151" class="code-line">Step 1: Initial scanning (Alerts 2, 3)</li>
                        <li data-line="152" class="code-line">Step 2: Remote attack against web server (Alerts 4, 5)</li>
                        <li data-line="153" class="code-line">Step 3: Privilege escalation (Alerts 6, 7)</li>
                    </ul>
                </li>
                <li data-line="154" class="code-line">Alert 1 should be discarded as irrelevant</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="156" class="code-line" id="alert-normalization">Alert Normalization</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>2</td>
                <td><strong>Portsacn</strong></td>
                <td>N2</td>
                <td>10.1/14.8</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1</td>
                <td></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="162" class="code-line">Goal: Unify alert formats form different types of sensors
            <ul>
                <li data-line="163" class="code-line">Not need to normalize for only one type of sensor</li>
            </ul>
        </li>
        <li data-line="164" class="code-line">Intrusion Detection Message Exchange Format (IDMEF)
            <ul>
                <li data-line="165" class="code-line">Proposed by the Internet Engineering Task Force</li>
            </ul>
        </li>
        <li data-line="166" class="code-line">Implemented using wrapper modules for different IDSs</li>
    </ul>
    <table>
        <thead>
            <tr>
                <th>Alert Attribute</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>alertid</td>
                <td>A unique ID identifying the alert</td>
            </tr>
            <tr>
                <td>analyzertime</td>
                <td>The time when the IDS sent the alert</td>
            </tr>
            <tr>
                <td>attackernodes</td>
                <td>The set of nodes where the attack originated</td>
            </tr>
            <tr>
                <td>attackgraph</td>
                <td>A graph showing the progress of complex attacks</td>
            </tr>
            <tr>
                <td>consequence</td>
                <td>A set of systems that are affected by this attack</td>
            </tr>
            <tr>
                <td>createtime</td>
                <td>The time when the IDS generated the alert</td>
            </tr>
            <tr>
                <td>detecttime</td>
                <td>The time when the IDS detected the attack</td>
            </tr>
            <tr>
                <td>end_time</td>
                <td>The time when the attack ended</td>
            </tr>
            <tr>
                <td>name The</td>
                <td>name of the attack</td>
            </tr>
            <tr>
                <td>priority</td>
                <td>A value indicating how important the attack is</td>
            </tr>
            <tr>
                <td>receivedtime</td>
                <td>The time the alert was received by the correlator</td>
            </tr>
            <tr>
                <td>reference</td>
                <td>A set of references to other alerts</td>
            </tr>
            <tr>
                <td>sensomode</td>
                <td>The node at which the IDS that generated the alert runs</td>
            </tr>
            <tr>
                <td>start_time</td>
                <td>The time when the attack started</td>
            </tr>
            <tr>
                <td>type</td>
                <td>The attack type (Reconnaissance, Breakin, Escalation, DoS)</td>
            </tr>
            <tr>
                <td>verified</td>
                <td>If the attack was successful (true, false, unknown)</td>
            </tr>
            <tr>
                <td>victimnodes</td>
                <td>The set of nodes that were victims of the attack</td>
            </tr>
            <tr>
                <td>victimprocess</td>
                <td>The full path of the process that was attacked</td>
            </tr>
            <tr>
                <td>victimservice</td>
                <td>Port number and protocol of the service that was attacked</td>
            </tr>
        </tbody>
    </table>
    <h3 data-line="190" class="code-line" id="alert-preprocessing">Alert Preprocessing</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>5</td>
                <td>Bad Request</td>
                <td>A</td>
                <td>22.1/22.1</td>
                <td><strong>10.0.0.1</strong></td>
                <td><strong>10.0.0.1</strong> <s>localhost</s>, Apache</td>
                <td></td>
            </tr>
            <tr>
                <td>6</td>
                <td>Local Exploit</td>
                <td>H</td>
                <td>24.6/24.6</td>
                <td><strong>10.0.0.1</strong></td>
                <td><strong>10.0.0.1</strong>, linuxconf</td>
                <td></td>
            </tr>
            <tr>
                <td>7</td>
                <td>Local Exploit</td>
                <td>H</td>
                <td>24.7/24.7</td>
                <td><strong>10.0.0.1</strong></td>
                <td><strong>10.0.0.1</strong>, linuxconf</td>
                <td></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="198" class="code-line">Some necessary fields are omited
            <ul>
                <li data-line="199" class="code-line">Start/End-time</li>
                <li data-line="200" class="code-line">Attck Source/Target</li>
                <li data-line="201" class="code-line">Additional Information</li>
            </ul>
        </li>
        <li data-line="202" class="code-line">Goal: Supply missing alert attributes as accurately as possible
            <ul>
                <li data-line="203" class="code-line">Use several heuristics</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="205" class="code-line" id="alert-fusion">Alert Fusion</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>2</td>
                <td>Scanning</td>
                <td>N2</td>
                <td>10.1/14.8</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1</td>
                <td>correlated</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Portsacn</td>
                <td>N1</td>
                <td>10.0/15.0</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1</td>
                <td>correlated</td>
            </tr>
            <tr>
                <td><strong>8</strong></td>
                <td><strong>Meta-Alert</strong></td>
                <td><strong>{N1, N2}</strong></td>
                <td><strong>10.8/14.8</strong></td>
                <td><strong>31.3.3.7</strong></td>
                <td><strong>10.0.0.7</strong></td>
                <td><strong>{2, 3}</strong></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="213" class="code-line">Goal: Combine alerts representing independent detection of a same attack by different IDSs
            <ul>
                <li data-line="214" class="code-line">Combine related alerts not related attacks</li>
                <li data-line="215" class="code-line">Not combine alerts produced by the same sensor</li>
            </ul>
        </li>
        <li data-line="216" class="code-line">Fusion: Temporal difference between alerts and information they contain
            <ul>
                <li data-line="217" class="code-line">Keep sliding time window of alerts
                    <ul>
                        <li data-line="218" class="code-line">Low window size causes related alerts to escape fusion</li>
                    </ul>
                </li>
                <li data-line="219" class="code-line">Alerts within the time window stored in a time-ordered queue</li>
                <li data-line="220" class="code-line">Upon new alert, compared to alerts in queue</li>
                <li data-line="221" class="code-line">Match if all overlapping attributes are equal and new alert is produced by a different sensor</li>
                <li data-line="222" class="code-line">Upon a match, alerts are merged; resulting meta-alert replaces the matched alert in the queue
                    <ul>
                        <li data-line="223" class="code-line">New timestamp: earlier start/end-time</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h3 data-line="225" class="code-line" id="alert-verification">Alert Verification</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>IIS Exploit</td>
                <td>N1</td>
                <td>12.0/12.0</td>
                <td>80.0.0.1</td>
                <td>10.0.0.1, port:80</td>
                <td><strong>nonrelevant</strong></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="231" class="code-line">Three types Alert
            <ul>
                <li data-line="232" class="code-line">True positive</li>
                <li data-line="233" class="code-line">Irrelevant positive
                    <ul>
                        <li data-line="234" class="code-line">Failed attack</li>
                    </ul>
                </li>
                <li data-line="235" class="code-line">False positive</li>
            </ul>
        </li>
        <li data-line="236" class="code-line">Goal: Extending intrusion detection signatures with an expected &quot;outcome&quot; of the attack
            <ul>
                <li data-line="237" class="code-line">Real-time verification</li>
                <li data-line="238" class="code-line">Visible and verifiable traces left by attack</li>
                <li data-line="239" class="code-line">Example: temporary file, outgoing connection</li>
            </ul>
        </li>
        <li data-line="240" class="code-line">Passive techniques
            <ul>
                <li data-line="241" class="code-line">Depend on the priori information
                    <ul>
                        <li data-line="242" class="code-line">Whether the attack target:
                            <ul>
                                <li data-line="243" class="code-line">Exist</li>
                                <li data-line="244" class="code-line">Running</li>
                                <li data-line="245" class="code-line">Reachable</li>
                                <li data-line="246" class="code-line">Reassemble the packets as expected by the intruder</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li data-line="247" class="code-line">Advantage
                    <ul>
                        <li data-line="248" class="code-line">Not interfere with the normal operation</li>
                    </ul>
                </li>
                <li data-line="249" class="code-line">Disadvantage
                    <ul>
                        <li data-line="250" class="code-line">Knowledge base/priori information undated not in time</li>
                        <li data-line="251" class="code-line">Limitation of the type of information</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li data-line="252" class="code-line">Active techniques
            <ul>
                <li data-line="253" class="code-line">Looking for the evidence of the success of an attack
                    <ul>
                        <li data-line="254" class="code-line">Established network connection</li>
                        <li data-line="255" class="code-line">Unknown ports opened (backdoor)</li>
                    </ul>
                </li>
                <li data-line="256" class="code-line">Vulnerability scanners
                    <ul>
                        <li data-line="257" class="code-line">Advantage
                            <ul>
                                <li data-line="258" class="code-line">Information is current</li>
                            </ul>
                        </li>
                        <li data-line="259" class="code-line">Disadvantage
                            <ul>
                                <li data-line="260" class="code-line">Visible on the network</li>
                                <li data-line="261" class="code-line">Consume network resources</li>
                                <li data-line="262" class="code-line">Cause crash</li>
                                <li data-line="263" class="code-line">Raise alarm, should be excluded</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li data-line="264" class="code-line">Remote login
                    <ul>
                        <li data-line="265" class="code-line">Advantage
                            <ul>
                                <li data-line="266" class="code-line">Gather high-quality data</li>
                            </ul>
                        </li>
                        <li data-line="267" class="code-line">Disadvantage
                            <ul>
                                <li data-line="268" class="code-line">Configure the target machine</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h3 data-line="270" class="code-line" id="attack-thread-reconstruction">Attack Thread Reconstruction</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>4</td>
                <td>Apache Exploit</td>
                <td>N1</td>
                <td>22.0/22.0</td>
                <td>31.3.3.7</td>
                <td>10.0.0.1 port:80</td>
                <td><strong>correlated</strong></td>
            </tr>
            <tr>
                <td>6</td>
                <td>Local Exploit</td>
                <td>H</td>
                <td>24.6/24.6</td>
                <td>10.0.0.1</td>
                <td>10.0.0.1, linuxconf</td>
                <td><strong>correlated</strong></td>
            </tr>
            <tr>
                <td>7</td>
                <td>Local Exploit</td>
                <td>H</td>
                <td>24.7/24.7</td>
                <td>10.0.0.1</td>
                <td>10.0.0.1, linuxconf</td>
                <td><strong>correlated</strong></td>
            </tr>
            <tr>
                <td>8</td>
                <td>Meta-Alert</td>
                <td>{N1, N2}</td>
                <td>10.8/14.8</td>
                <td>31.3.3.7</td>
                <td>10.0.0.7</td>
                <td>{2, 3}, <strong>correlated</strong></td>
            </tr>
            <tr>
                <td><strong>9</strong></td>
                <td><strong>Meta-Alert</strong></td>
                <td><strong>{N1, N2}</strong></td>
                <td><strong>10.8/22.0</strong></td>
                <td><strong>31.3.3.7</strong></td>
                <td><strong>10.0.0.7, port:80</strong></td>
                <td><strong>{4, 8}</strong></td>
            </tr>
            <tr>
                <td><strong>10</strong></td>
                <td><strong>Meta-Alert</strong></td>
                <td><strong>H</strong></td>
                <td><strong>24.6/24.7</strong></td>
                <td><strong>10.0.0.1</strong></td>
                <td><strong>10.0.0.1, linuxconf</strong></td>
                <td><strong>{6, 7}</strong></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="281" class="code-line">Goal: Combines a series of alerts due to attacks by one attacker against a single target</li>
        <li data-line="282" class="code-line">Merging alerts with equivalent source and target attributes in temporal proximity
            <ul>
                <li data-line="283" class="code-line">Set time windows: 120s</li>
            </ul>
        </li>
        <li data-line="284" class="code-line">Reduce a lot of alerts caused by brute-force attack</li>
    </ul>
    <h3 data-line="286" class="code-line" id="attack-session-reconstruction">Attack Session Reconstruction</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>5</td>
                <td>Bad Request</td>
                <td>A</td>
                <td>22.1/22.1</td>
                <td>10.0.0.1</td>
                <td>10.0.0.1, Apache</td>
                <td><strong>correlated</strong></td>
            </tr>
            <tr>
                <td>9</td>
                <td>Meta-Alert</td>
                <td>{N1, N2}</td>
                <td>10.8/22.0</td>
                <td>31.3.3.7</td>
                <td>10.0.0.7, port:80</td>
                <td>{4, 8}, <strong>correlated</strong></td>
            </tr>
            <tr>
                <td><strong>11</strong></td>
                <td><strong>Meta-Alert</strong></td>
                <td><strong>{N1, N2, A}</strong></td>
                <td><strong>10.0/22.1</strong></td>
                <td><strong>{31.3.3.7, 10.0.0.1}</strong></td>
                <td><strong>10.0.0.1, port:80, Apache</strong></td>
                <td><strong>{5, 9}</strong></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="294" class="code-line">Goal: Link network-based alerts to related host-based alerts</li>
        <li data-line="295" class="code-line">Rough spatial and temporal correspondence between the alerts
            <ul>
                <li data-line="296" class="code-line">The host-based attack occurs a short time after the network-based attack
                    <ul>
                        <li data-line="297" class="code-line">Simple but imprecise</li>
                    </ul>
                </li>
                <li data-line="298" class="code-line">Priori information
                    <ul>
                        <li data-line="299" class="code-line">Prepare for or to be a precondition for another attack</li>
                        <li data-line="300" class="code-line">Manually encoded in a knowledge base</li>
                    </ul>
                </li>
                <li data-line="301" class="code-line">Sliding time window with extended timeout model
                    <ul>
                        <li data-line="302" class="code-line">New related alert arrives, extend timeout</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h3 data-line="304" class="code-line" id="attack-focus-recognition">Attack Focus Recognition</h3>
    <ul>
        <li data-line="306" class="code-line">Goal: identify hosts that are either the source or the target of a substantial number of attacks
            <ul>
                <li data-line="307" class="code-line">DDoS: many2one</li>
                <li data-line="308" class="code-line">Port scan: one2many</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="310" class="code-line" id="multistep-correlation">Multistep Correlation</h3>
    <table>
        <thead>
            <tr>
                <th>AlertID</th>
                <th>Name</th>
                <th>Sensor</th>
                <th>Start/End</th>
                <th>Source</th>
                <th>Target</th>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>10</td>
                <td>Meta-Alert</td>
                <td>H</td>
                <td>24.6/24.7</td>
                <td>10.0.0.1</td>
                <td>10.0.0.1, linuxconf</td>
                <td>{6, 7} <strong>correlated</strong></td>
            </tr>
            <tr>
                <td>11</td>
                <td>Meta-Alert</td>
                <td>{N1, N2, A}</td>
                <td>10.0/22.1</td>
                <td>{31.3.3.7, 10.0.0.1}</td>
                <td>10.0.0.1, port:80, Apache</td>
                <td>{5, 9} <strong>correlated</strong></td>
            </tr>
            <tr>
                <td><strong>12</strong></td>
                <td><strong>Meta-Alert</strong></td>
                <td><strong>{N1, N2, H, A}</strong></td>
                <td><strong>10.0/24.7</strong></td>
                <td><strong>{31.3.3.7, 10.0.0.1}</strong></td>
                <td><strong>10.0.0.1, port:80, Apache, linuxconf</strong></td>
                <td><strong>{10, 11}</strong></td>
            </tr>
        </tbody>
    </table>
    <ul>
        <li data-line="318" class="code-line">Goal: identify high-level attack patterns that are composed of several individual attacks</li>
        <li data-line="319" class="code-line">Example
            <ul>
                <li data-line="320" class="code-line">Scans a victim host</li>
                <li data-line="321" class="code-line">Breaks into a user account on that host</li>
                <li data-line="322" class="code-line">Escalates privileges to the root</li>
            </ul>
        </li>
    </ul>
    <h3 data-line="324" class="code-line" id="impact-analysis">Impact Analysis</h3>
    <ul>
        <li data-line="326" class="code-line">Goal: determine the impact of an attack on the proper operation of the protected network</li>
        <li data-line="327" class="code-line">Heartbeat monitor</li>
    </ul>
    <h3 data-line="329" class="code-line" id="alert-prioritization">Alert Prioritization</h3>
    <ul>
        <li data-line="331" class="code-line">Classify alerts</li>
        <li data-line="332" class="code-line">Discard irrelevant or less importance alerts</li>
    </ul>
    <table>
        <thead>
            <tr>
                <th>Priority</th>
                <th>AlertID</th>
                <th>Description</th>
                <th>Tag</th>
                <th>Reference</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>High</td>
                <td>12</td>
                <td>Multistep Attack Scenario</td>
                <td></td>
                <td>{11, 10}</td>
            </tr>
            <tr>
                <td>Low</td>
                <td>2-11</td>
                <td>...</td>
                <td>correlated</td>
                <td>...</td>
            </tr>
            <tr>
                <td>Low</td>
                <td>1</td>
                <td>IIS Exploit</td>
                <td>nonrelevant</td>
                <td></td>
            </tr>
        </tbody>
    </table>
    <h2 data-line="340" class="code-line" id="reference">Reference</h2>
    <ul>
        <li data-line="342" class="code-line">A Comprehensive Approach to Intrusion Detection Alert Correlation, Valeur et al, 2004</li>
        <li data-line="343" class="code-line">Lecture 20</li>
    </ul>

</body>

</html>